---
import LinkButton from '@/components/LinkButton';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { USD } from '@/lib/format';
import type { MakerStats } from '@/pages/makers/index.astro';
import { ArrowRight } from 'lucide-react';

type Props = { stats: MakerStats };

const { stats } = Astro.props;
const { company, maker, controllerCount, currentlySoldCount, avgPrice, latestYear } = stats;
---

<Card className="group py-4 transition-colors hover:border-primary/50">
  <CardHeader>
    <CardTitle className="text-xl transition-colors hover:underline group-hover:text-primary">
      <a href={`/makers/${company}`}>{maker}</a>
    </CardTitle>
    <CardDescription>
      {controllerCount} controller{controllerCount !== 1 ? 's' : ''}
      {currentlySoldCount > 0 && <> - {currentlySoldCount} available</>}
    </CardDescription>
  </CardHeader>

  <CardContent className="space-y-2 text-sm">
    {
      avgPrice && (
        <div class="flex items-center justify-between">
          <span class="text-muted-foreground">Avg Price</span>
          <span class="font-mono">{USD.format(avgPrice)}</span>
        </div>
      )
    }

    <div class="flex items-center justify-between">
      <span class="text-muted-foreground">Latest Release</span>
      <span class="font-mono">{latestYear}</span>
    </div>

    <LinkButton href={`/makers/${company}`} variant="ghost" className="w-full">
      View All Controllers
      <ArrowRight className="ml-2 size-4" />
    </LinkButton>
  </CardContent>
</Card>
